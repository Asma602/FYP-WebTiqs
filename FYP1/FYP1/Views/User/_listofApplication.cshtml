@model IEnumerable<FYP1.ViewModel.applicationDatabase>

@{ int counter = 0;}
@foreach (var item in Model)
{
    counter++;
    <tr>
        <th scope="row" class="text-center">@counter</th>
        <td class="text-left">@item.userApplications.appName  
            <span class="pull-right" style="font-size:20px;cursor:pointer">
                <i class="fa fa-cog" style="color:#00796B;" 
                   id="@item.userApplications.appName"
                   onclick="setAppData(this.id)"
                   data-toggle="modal" data-target="#manageAppDataModal"></i>
            </span>
        </td>
        
        <td class="text-center"><img src="~/logo/@item.userApplications.appLogo" style="height:50px;width:50px" alt="Alternate Text" /></td>
        <td class="text-center">
            <form asp-action="Index" asp-controller="EditUserApplication" method="post">
                <input type="text" name="dbName" value="@item.appDatabases.dbName" hidden />
                <span>
                    <button type="submit" id="previewSystem" style="text-transform: none"
                            title="Add new forms"
                            class="btn btn-teal text-white btn-sm m-0 ">
                        <i class="fa fa-plus fa-2x"></i>
                    </button>
                </span>

                @*<span>
                    <a  id="previewSystem" style="text-transform: none"
                            title="Delete forms" asp-action="previewSystem" asp-controller="form"
                            class="btn btn-teal text-white btn-sm m-0 pl-3 pr-3 pt-2 pb-2 ml-2">
                        <i class="fa fa-trash-o fa-2x"></i>
                    </a>
                </span>*@
            </form>
        </td>
        <td class="text-center">
            <form asp-action="Index" asp-controller="EditDatabase" method="post">
                <input type="text" name="dbName" value="@item.appDatabases.dbName" hidden />
                <span> <button type="submit" id="previewSystem" title="Edit Storage" style="text-transform:none"
                               class="btn btn-teal text-white btn-sm m-0"> <i class="fa fa-edit fa-2x"></i></button></span>
            </form>
        </td>
        <td class="text-center">
            @{ var deleteApplicationID = counter + "deleteApplication";}
            <input type="text" name="appName" value="@item.userApplications.appName" readonly id=@deleteApplicationID hidden />
            <span>
                <button type="button" id="@counter"
                        style="text-transform:none"
                        class="btn btn-teal text-white btn-sm m-0"
                        onclick="onAppDelete(this.id)"
                        data-toggle="modal" data-target="#confirmAppDeleteModal">
                    <i class="fa fa-trash-o fa-2x"></i>
                </button>
            </span>
            @**@
        </td>
        <td class="text-center">
          
            <button id="@item.appDatabases.dbName" onclick="setDbName(this.id)" data-toggle="modal" data-target="#modalLoginForm" 
                    style="text-transform:none"
                    class="btn btn-teal text-white btn-sm m-0">
                    <i class="fa fa-sign-in fa-2x"></i>
            </button>
        </td>
    </tr>

}

<div class="modal fade" id="confirmAppDeleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#2A3542">
                <h5 class="modal-title" id="exampleModalLabel">Confirm delete</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this application?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-dark text-white btn-sm m-0 mr-2" data-dismiss="modal">Close</button>
                <button type="submit" 
                        onclick="deleteApplication(this.id)"
                        class="btn btn-teal text-white btn-sm m-0 confirmDeleteBtn">
                        Delete
                </button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="manageAppDataModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#2A3542">
                <h5 class="modal-title" id="exampleModalLabel">Change Application Data</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="manageAppData" enctype="multipart/form-data"  method="post">
                    <input type="text" id="appOldName" name="appOldName" hidden />
                    <input type="text" id="appNewName" name="appNewName"
                           class="form-control mb-4" placeholder="Application Name">
                    <input type="password" id="appOldPassword" name="appOldPassword"
                           class="form-control mb-4" placeholder="Enter current password" />
                    <input type="password" id="appNewPassword" name="appNewPassword"
                           class="form-control mb-4" placeholder="Enter new password" />
                    <input type="file" name="appLogoChange"
                           class="form-control mb-4" placeholder="Application Logo">
                    <div class="modal-footer">
                        <button type="button" class="btn btn-dark text-white btn-sm m-0 mr-2" data-dismiss="modal">Close</button>
                        <button type="submit"
                                class="btn btn-teal text-white btn-sm m-0 ">
                            Save changes
                        </button>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</div>
<script>
    function onAppDelete(id) {
        $(".confirmDeleteBtn").attr("id", id);
    }
    function setAppData(appName) {
        $("#appNewName").attr("value", appName);
     $("#appOldName").attr("value", appName);

    }
    //function setAppData(appName) {

    //    $.ajax({
    //        url: "/Home/setAppName",
    //        type: "POST",
    //        data: {
    //            appName:appName
    //        },
    //        success: function (data) {
    //            //$("#applicationDisplay").html(data);
    //            //location.reload();
    //        },
    //        error: function (err) {
    //            console.error();
    //        }
    //    });
    //}
</script>


